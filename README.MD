## ChatRoom

ğŸš€ğŸš€ğŸš€åŸºäºNIOã€å•Rectorå¤šçº¿ç¨‹æ¨¡å‹å®ç°çš„èŠå¤©å®¤ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ ï¼š

- å¿«é€Ÿå›é¡¾NIOç¼–ç¨‹æ¨¡å‹ï¼›
- å¿«é€Ÿå›é¡¾å•Rectorå¤šçº¿ç¨‹æ¨¡å‹ï¼›
- å¿«é€ŸæŒæ¡ä¸€ä¸ªèŠå¤©å®¤çš„åŸºæœ¬åŠŸèƒ½ã€‚

ğŸš€ğŸš€ğŸš€é¡¹ç›®æ¶æ„ï¼š

 ![Project Structure](https://github.com/MagicFollower/chatroom/blob/main/docs/img/structure.png)

ğŸ”¥æä¾›ä¼˜åŒ–æ–¹æ¡ˆæ¶æ„ï¼ˆäºŒï¼‰ğŸ”¥

- ä¸»ä»Reactorå¤šçº¿ç¨‹æ¨¡å‹
- å°½é‡å‡å°‘æ¥å—è¿æ¥çº¿ç¨‹çš„å‹åŠ›ï¼Œä½¿å…¶æ›´å¿«çš„å“åº”æ›´å¤šè¿æ¥ï¼Œå•ç‹¬ä½¿ç”¨1ä¸ªæˆ–å¤šä¸ªSubReactorçº¿ç¨‹å¤„ç†è½¬å‘è¯·æ±‚ï¼›
  - å¦‚æœå­˜åœ¨å¤šä¸ªSubReactorçº¿ç¨‹ï¼Œacceptè·å¾—çš„å®¢æˆ·ç«¯SocketChannelå¯ä»¥å­˜æ”¾åœ¨ä¸åŒçš„BlockingQueueä¸­ï¼Œä¾›å¤šä¸ªSubReactorçº¿ç¨‹æ¶ˆè´¹ï¼Œä»¥åŠ å¿«dispatché€Ÿåº¦ï¼›
- è¿™ç§æ–¹æ¡ˆè¢«è¯å®å­˜åœ¨è®¾è®¡é—®é¢˜ğŸ˜Ÿï¼Œè¯·å‚è€ƒæ¶æ„æ–¹æ¡ˆä¸‰ã€‚

 ![Project Structure](https://github.com/MagicFollower/chatroom/blob/main/docs/img/update-structure.png)

ğŸ”¥æ¶æ„æ–¹æ¡ˆï¼ˆä¸‰ï¼‰ğŸ”¥

- å°†Workeréœ€è¦æ‰§è¡Œçš„ä»»åŠ¡æŠ½è±¡ä¸ºTaskï¼Œç”±å¤šä¸ªDispatcherç»Ÿä¸€å­˜æ”¾è¿›å…¥TaskQueueï¼ŒWorkeråªéœ€è¦å…³æ³¨äºå¼‚æ­¥æ¶ˆè´¹Taskï¼›
  - <u>WorkerèŒèƒ½å•ä¸€åŒ–ï¼Œæ³¨å†Œä¸ç›‘å¬åŠŸèƒ½ä¸‹æ–¹åˆ°Dispatcher</u>ï¼›
  - å¼•å…¥TaskQueueï¼Œå¼‚æ­¥æ¶ˆè´¹Taskï¼Œé¿å…ä¹‹å‰æ–¹æ¡ˆä¸­å‡ºç°ä»»åŠ¡è€—æ—¶ï¼Œé˜»å¡æ•´ä¸ªæ³¨å†Œåœ¨Workerçº¿ç¨‹Selectorä¸Šæ‰€æœ‰å®¢æˆ·ç«¯äº‹ä»¶çš„æƒ…å†µğŸ’£
- å·¥ä½œä»»åŠ¡çº¿ç¨‹æ± æ•°é‡ï¼Œå»ºè®®é‡‡å–å¯ç”¨å¤„ç†å™¨æ•°*2ï¼Œåˆé€‚çš„çº¿ç¨‹æ•°èƒ½å¤Ÿå¾ˆå¥½åº”å¯¹éƒ¨åˆ†è€—æ—¶çš„å¤„ç†æ“ä½œã€‚
  - ```Runtime.getRuntime().availableProcessors()*2```

 ![Project Structure](https://github.com/MagicFollower/chatroom/blob/main/docs/img/update-structure-2.png)

ğŸ”¥ä¼˜åŒ–æ€è·¯ï¼ˆå››ï¼‰ğŸ”¥

- å°†æ‰€æœ‰å®¢æˆ·ç«¯äº‹ä»¶å…¨éƒ¨æ”¾åˆ°ä¸€ä¸ªTaskQueueä¸­å¯èƒ½ä¸æ˜¯ä¸€ä¸ªæœ€ä½³çš„é€‰æ‹©ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯è®¾ç½®å•ç‹¬çš„TaskQueueï¼›
  - å°†å®¢æˆ·ç«¯æ‰€æœ‰ç›¸å…³çš„ä¿¡æ¯ï¼Œå°è£…ä¸ºContextï¼ˆctxï¼‰ï¼Œç„¶åç»Ÿä¸€ç®¡ç†æ‰€æœ‰ä¸Šä¸‹æ–‡æˆ–æ‰€æœ‰TaskQueueï¼›
- ç”±äºæ¯ä¸€ä¸ªè¿æ¥çš„å®¢æˆ·ç«¯å¯¹åº”ä¸€ä¸ªContextï¼Œæˆ‘ä»¬å¯ä»¥å–æ¶ˆå•ç‹¬ç”¨äºå­˜å‚¨åœ¨çº¿ç”¨æˆ·çš„æ•°æ®ç»“æ„ï¼›
- å®¢æˆ·ç«¯ç›‘å¬æ‰€æœ‰ä¸Šä¸‹æ–‡æˆ–æ‰€æœ‰TaskQueueï¼Œå®Œæˆäº‹ä»¶çš„å¼‚æ­¥æ¶ˆè´¹ã€‚

 ![Project Structure](https://github.com/MagicFollower/chatroom/blob/main/docs/img/update-structure-3.png)

ğŸ”¥æ¶æ„æ–¹æ¡ˆï¼ˆå››ï¼‰ğŸ”¥

- æ˜ç¡®ã€ä¼˜åŒ–æ€è·¯ï¼ˆå››ã€‘ä¸­ä»»åŠ¡é˜Ÿåˆ—æ‰€åœ¨çš„ä½ç½®åŠå„ä¸ªç»„ä»¶çš„å…·ä½“èŒè´£ï¼›
- æä¾›å¤šç±»å‹ä»»åŠ¡é˜Ÿåˆ—ï¼ˆCommonTaskQueueã€ScheduledTaskQueueï¼‰ï¼›

 ![Project Structure](https://github.com/MagicFollower/chatroom/blob/main/docs/img/update-structure-4.png)



